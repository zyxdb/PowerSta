# PowerSta稳功仪上位机

已实现功能：

实时显示功率、绘图与保存（10.11）

平均数、标准差（10.12）

一启动就自动显示总体平均数、标准差（10.14）

将曲线数据、当前功率、实时功率、平均功率、标准差保存在csv文件里面（11.12）

### 2022-4-14  

1.画图的时候加上校验，如果是打开or关闭开关回执的数据，就不绘制在曲线上。

2.关闭串口后，禁止点击绘图的开始和停止按钮。

3.加上了当读入数据时，才开始画图的判断。

### 2022-4-27  

修复了之前延迟严重的问题。在接收线程中由原先的Sleep(500)改为Sleep(150)

### 2022-4-29  

exe文件目录中新建一个文件夹，命名“数据汇总”

每2个小时自动生成一个文件夹，文件夹命名为当时时间，如202204291535

在生成的文件夹中保存一次csv文件和jpg文件，命名为当时时间，如202204291535.csv

2个小时之前的数据销毁

### 2022-5-27  

增加了com口的数量。由原先的9增加到了20。需要注意的是用CreateFile打开10以上的com口是需要变化的

### 2022-6-1  

交付过去后出现一个新的情况，win7版本运行程序时不正常。

经过排查后初步锁定是动态链接库导致的原因，于是将MFC的使用改成“在静态链接库中使用MFC”；相对应的公共语言运行时也改为“无公共语言运行时支持”

仍报错。排查发现是原先代码使用了一个MFC库里的类CMFCTabCtrl。MFC库用静态链接多多少少都会有问题，不适配无MFC环境的电脑。于是把绘图区域的部分由原先的动态创建改为静态创建，报错消除。